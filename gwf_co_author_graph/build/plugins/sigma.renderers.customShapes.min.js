!function(t){"use strict";function e(t,e,i){l.push({name:t,drawShape:e,drawBorder:i})}function i(r){return function(t,e,i,a,l,n){n.fillStyle=l,n.beginPath(),r(t,e,i,a,n),n.closePath(),n.fill()}}function a(r){return function(t,e,i,a,l,n){n.strokeStyle=l,n.lineWidth=a/5,n.beginPath(),r(t,e,i,a,n),n.closePath(),n.stroke()}}var l=[],n=function(t,e,i,a,l){var n=45*Math.PI/180;l.moveTo(e+a*Math.sin(n),i-a*Math.cos(n));for(var r=1;r<4;r++)l.lineTo(e+Math.sin(n+2*Math.PI*r/4)*a,i-Math.cos(n+2*Math.PI*r/4)*a)};e("square",i(n),a(n));n=function(t,e,i,a,l){l.arc(e,i,a,0,2*Math.PI,!0)};e("circle",i(n),a(n));n=function(t,e,i,a,l){l.moveTo(e-a,i),l.lineTo(e,i-a),l.lineTo(e+a,i),l.lineTo(e,i+a)};e("diamond",i(n),a(n));n=function(t,e,i,a,l){t=t.cross&&t.cross.lineWeight||5;l.moveTo(e-a,i-t),l.lineTo(e-a,i+t),l.lineTo(e-t,i+t),l.lineTo(e-t,i+a),l.lineTo(e+t,i+a),l.lineTo(e+t,i+t),l.lineTo(e+a,i+t),l.lineTo(e+a,i-t),l.lineTo(e+t,i-t),l.lineTo(e+t,i-a),l.lineTo(e-t,i-a),l.lineTo(e-t,i-t)};e("cross",i(n),a(n));n=function(t,e,i,a,l){var n=t.equilateral&&t.equilateral.numPoints||5,r=(t.equilateral&&t.equilateral.rotate||0)*Math.PI/180,o=a;l.moveTo(e+o*Math.sin(r),i-o*Math.cos(r));for(var s=1;s<n;s++)l.lineTo(e+Math.sin(r+2*Math.PI*s/n)*o,i-Math.cos(r+2*Math.PI*s/n)*o)};e("equilateral",i(n),a(n));n=function(t,e,i,a,l){var n=t.star&&t.star.numPoints||5,r=a,o=a*(t.star&&t.star.innerRatio||.5),s=Math.PI/n;l.moveTo(e,i-a);for(var c=0;c<n;c++)l.lineTo(e+Math.sin(s+2*Math.PI*c/n)*o,i-Math.cos(s+2*Math.PI*c/n)*o),l.lineTo(e+Math.sin(2*Math.PI*(c+1)/n)*r,i-Math.cos(2*Math.PI*(c+1)/n)*r)};e("star",i(n),a(n));e("pacman",function(t,e,i,a,l,n){n.fillStyle="yellow",n.beginPath(),n.arc(e,i,a,1.25*Math.PI,0,!1),n.arc(e,i,a,0,.75*Math.PI,!1),n.lineTo(e,i),n.closePath(),n.fill(),n.fillStyle="white",n.strokeStyle="black",n.beginPath(),n.arc(e+a/3,i-a/3,a/4,0,2*Math.PI,!1),n.closePath(),n.fill(),n.stroke(),n.fillStyle="black",n.beginPath(),n.arc(e+4*a/9,i-a/3,a/8,0,2*Math.PI,!1),n.closePath(),n.fill()},null),this.ShapeLibrary={enumerate:function(){return l},version:"0.1"}}.call(this),function(t){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";if("undefined"==typeof ShapeLibrary)throw"ShapeLibrary is not declared";sigma.utils.pkg("sigma.canvas.nodes"),sigma.utils.pkg("sigma.svg.nodes");var h=t,d={},c=function(t,e,i,a,l){var n,r,o,s,c,u;h&&t.image&&t.image.url&&(n=t.image.url,r=t.image.h||1,c=t.image.w||1,u=t.image.scale||1,o=t.image.clip||1,(s=d[n])||((s=document.createElement("IMG")).src=n,s.status="loading",s.onerror=function(){console.log("error loading",n),s.status="error"},s.onload=function(){console.log("redraw on image load",n),s.status="ok",h.refresh()},d[n]=s),t=c<r?c/r:1,c=r<c?r/c:1,u=a*u,l.save(),l.beginPath(),l.arc(e,i,a*o,0,2*Math.PI,!0),l.closePath(),l.clip(),"ok"===s.status&&l.drawImage(s,e+Math.sin(-.7855)*u*t,i-Math.cos(-.7855)*u*c,u*t*2*Math.sin(-.7855)*-1,u*c*2*Math.cos(-.7855)),l.restore())},l=function(t,e,i){var a,l,n,r,o;h&&t.image&&t.image.url&&(a=document.createElementNS(i("xmlns"),"circle"),o=document.createElementNS(i("xmlns"),"clipPath"),l=i("classPrefix")+"-clip-path-"+t.id,n=document.createElementNS(i("xmlns"),"defs"),r=document.createElementNS(i("xmlns"),"image"),t.image.url,o.setAttributeNS(null,"id",l),o.appendChild(a),n.appendChild(o),o=(o=/MSIE [5-9]/.test(navigator.userAgent)?"":document.location.href).split("#")[0],r.setAttributeNS(null,"class",i("classPrefix")+"-node-image"),r.setAttributeNS(null,"clip-path","url("+o+"#"+l+")"),r.setAttributeNS(null,"pointer-events","none"),r.setAttributeNS("http://www.w3.org/1999/xlink","href",t.image.url),e.appendChild(n),e.appendChild(r))};ShapeLibrary.enumerate().forEach(function(t){var e,o,s;e=t.name,o=t.drawShape,s=t.drawBorder,sigma.canvas.nodes[e]=function(t,e,i){var a=i("prefix")||"",l=t[a+"size"],n=t.color||i("defaultNodeColor"),r=t.borderColor||n,i=t[a+"x"],a=t[a+"y"];e.save(),o&&o(t,i,a,l,n,e),s&&s(t,i,a,l,r,e),c(t,i,a,l,e),e.restore()},sigma.svg.nodes[e]={create:function(t,e){var i=document.createElementNS(e("xmlns"),"g"),a=document.createElementNS(e("xmlns"),"circle");return i.setAttributeNS(null,"class",e("classPrefix")+"-node-group"),i.setAttributeNS(null,"data-node-id",t.id),a.setAttributeNS(null,"data-node-id",t.id),a.setAttributeNS(null,"class",e("classPrefix")+"-node"),a.setAttributeNS(null,"fill",t.color||e("defaultNodeColor")),i.appendChild(a),l(t,i,e),i},update:function(t,e,i){for(var a=i("classPrefix"),l=t.image.clip||1,n=t.image.h||1,r=t.image.w||1,o=i("prefix")||"",s=t.image.scale||1,c=t[o+"size"],u=t[o+"x"],h=t[o+"y"],d=s*c,f=r<n?r/n:1,m=n<r?n/r:1,g=0,S=e.childNodes;g<S.length;g++)switch(S[g].getAttribute("class")){case a+"-node":S[g].setAttributeNS(null,"cx",u),S[g].setAttributeNS(null,"cy",h),S[g].setAttributeNS(null,"r",c),i("freeStyle")||S[g].setAttributeNS(null,"fill",t.color||i("defaultNodeColor"));break;case a+"-node-image":S[g].setAttributeNS(null,"x",u+Math.sin(-.7855)*d*f),S[g].setAttributeNS(null,"y",h-Math.cos(-.7855)*d*m),S[g].setAttributeNS(null,"width",d*f*2*Math.sin(-.7855)*-1),S[g].setAttributeNS(null,"height",d*m*2*Math.cos(-.7855));break;default:var p,M=S[g].firstChild;null!=M&&(p=a+"-clip-path-"+t.id,M.getAttribute("id")===p&&(M.firstChild.setAttributeNS(null,"cx",u),M.firstChild.setAttributeNS(null,"cy",h),M.firstChild.setAttributeNS(null,"r",l*c)))}e.style.display=""}}}),this.CustomShapes={init:function(t){h=t},version:"0.1"}}.call(this);