!function(){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";function t(e,n){sigma.classes.dispatcher.extend(this);var c=this,g=e,i=document.body,m=n,o=n.container.lastChild,v=n.camera,f=null,p="",t=[],r={},d=!1,h=!1;function x(e){function n(e){return parseInt(t.getPropertyValue(e).replace("px",""))||0}var t=window.getComputedStyle(e);return{left:e.getBoundingClientRect().left+n("padding-left"),top:e.getBoundingClientRect().top+n("padding-top")}}function a(e){r[e.data.node.id]||(t.push(e.data.node),r[e.data.node.id]=!0,t.length&&!d&&(f=t[t.length-1],o.addEventListener("mousedown",u)))}function s(e){var n=t.map(function(e){return e}).indexOf(e.data.node);t.splice(n,1),delete r[e.data.node.id],t.length&&!d?f=t[t.length-1]:o.removeEventListener("mousedown",u)}function u(e){d=!0;var n,t,r=g.graph.nodes().length;if(f&&1<r){for(n in o.removeEventListener("mousedown",u),i.addEventListener("mousemove",b),i.addEventListener("mouseup",l),g.cameras)void 0!==(t=g.cameras[n]).edgequadtree&&(t.edgequadtree._enabled=!1);m.settings({mouseEnabled:!1,enableHovering:!1}),g.refresh(),c.dispatchEvent("startdrag",{node:f,captor:e,renderer:m})}}function l(e){var n,t;for(n in d=!1,o.addEventListener("mousedown",u),i.removeEventListener("mousemove",b),i.removeEventListener("mouseup",l),g.cameras)void 0!==(t=g.cameras[n]).edgequadtree&&(t.edgequadtree._enabled=!0);m.settings({mouseEnabled:!0,enableHovering:!0}),g.refresh(),h&&c.dispatchEvent("drop",{node:f,captor:e,renderer:m}),c.dispatchEvent("dragend",{node:f,captor:e,renderer:m}),h=!1,f=null}function b(l){var e;function n(){for(var e,n,t=x(m.container),r=l.clientX-t.left,t=l.clientY-t.top,i=Math.cos(v.angle),o=Math.sin(v.angle),d=g.graph.nodes(),a=[],s=0;s<2;s++){var u=d[s],u={x:u.x*i+u.y*o,y:u.y*i-u.x*o,renX:u[p+"x"],renY:u[p+"y"]};a.push(u)}t=a[0].x===a[1].x&&a[0].y===a[1].y?(e=0===a[0].renX?1:a[0].renX,n=0===a[0].renY?1:a[0].renY,r=a[0].x/e*(r-a[0].renX)+a[0].x,a[0].y/n*(t-a[0].renY)+a[0].y):(e=(a[1].renX-a[0].renX)/(a[1].x-a[0].x),n=(a[1].renY-a[0].renY)/(a[1].y-a[0].y),a[1].x===a[0].x&&(e=n),a[1].y===a[0].y&&(n=e),r=(r-a[0].renX)/e+a[0].x,(t-a[0].renY)/n+a[0].y),f.x=r*i-t*o,f.y=t*i+r*o,g.refresh(),h=!0,c.dispatchEvent("drag",{node:f,captor:l,renderer:m})}-1<navigator.userAgent.toLowerCase().indexOf("firefox")?(clearTimeout(e),setTimeout(n,0)):n()}n instanceof sigma.renderers.svg&&(o=n.container.firstChild),p=n instanceof sigma.renderers.webgl?n.options.prefix.substr(5):n.options.prefix,n.bind("overNode",a),n.bind("outNode",s),n.bind("click",function(e){d=!1,i.removeEventListener("mousemove",b),i.removeEventListener("mouseup",l),t.length||(f=null)}),g.bind("kill",function(){c.unbindAll()}),this.unbindAll=function(){o.removeEventListener("mousedown",u),i.removeEventListener("mousemove",b),i.removeEventListener("mouseup",l),m.unbind("overNode",a),m.unbind("outNode",s)}}sigma.utils.pkg("sigma.plugins");var r={};sigma.plugins.dragNodes=function(e,n){return r[e.id]||(r[e.id]=new t(e,n)),e.bind("kill",function(){sigma.plugins.killDragNodes(e)}),r[e.id]},sigma.plugins.killDragNodes=function(e){r[e.id]instanceof t&&(r[e.id].unbindAll(),delete r[e.id])}}.call(window);